<h1>Flight Index</h1>

<%= form_with url: "/flights", method: :get do |f| %>

  <div>
    <%= f.label :origin_id %><br />
    <%= f.select(:origin_id,
                 options_for_select(@airport_options, params[:origin_id]),
                 required: true ) %>
  </div>

  <div>
    <%= f.label :destination_id %><br />
    <%= f.select(:destination_id,
                 options_for_select(@airport_options, params[:destination_id]),
                 required: true ) %>
  </div>

  <div>
    <%= f.label "Number of Passengers" %><br />
    <%= f.select(:number,
                 options_for_select([1, 2, 3, 4], params[:number]),
                 required: true ) %>
  </div>

  <div>
    <%= f.label "Date" %><br />
    <%= f.date_field :departure_date,
                      value: params[:departure_date],
                      required: true,
                      placeholder: "dd/mm/yyyy" %>
  </div>

  <div>
    <%= f.submit "Find Flights" %>
  </div>
<% end %>

<% if @connecting_flights %>
  <h2>Connecting Flights:</h2>
  <% @connecting_flights.each do |connection| %>
    <p>
      <strong>From: </strong>
      <%= connection[0].details %>
      <strong> To: </strong>
      <%= connection[1].details %>
    </p>
  <% end %>
<% end %>

<% if @available_flights %>
  <div class="flight-results">
    <h2>Available Flights:</h2>
    <%= form_with url: "bookings/new/", method: "get", local: true do |f| %>
      <%= f.hidden_field :number, :value => params[:number] %>
      <%= f.collection_radio_buttons :flight_id, @available_flights, :id, :details do |option| %>
        <p>
          <%= option.radio_button %>
          <%= option.label %>
        </p>
      <% end %>
      <%# if @connecting_flights %>
        <%# <h2>Connecting Flights:</h2> %>
        <%#= f.collection_radio_buttons :connection_id, @connecting_flights, :id, :details do |option| %>
          <%# <p> %>
            <%#= option.radio_button %>
            <%#= option.label %>
          <%# </p> %>
        <%# end %>
      <%# end %>
      <%= f.submit "Book Flight" %>
    <% end %>
  </div>
<% end %>
